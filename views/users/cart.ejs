

<%- include('../layouts/userHeader') %>

<br><br><br>
<br>
<h2>Shopping Cart</h2>

<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>S no</th>
                        <th scope="col">Product Name</th>
                        <th scope="col">Image</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Total Price</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    <% if (cartDetails && cartDetails.product.length > 0) { %>
                        <% cartDetails.product.forEach((product, index) => { %>
                            <tr>
                                <td><%= index + 1 %></td>
                                <td><b><%= product.productId.productName %></b></td>
                                <td><img src="userImages/<%= product.productId.images[0] %>" alt="Product Image" style="max-width: 100px; max-height: 100px;"></td>

                                <td>$<%= product.productId.price.toFixed(2) %></td>
                                <td><%= product.quantity %></td>
                                <td>$<%= product.totalPrice.toFixed(2) %></td>
                                <td>
                                    <button class="remove-product btn btn-danger remove-btn" data-product-id="<%= product._id %>">
                                        Remove
                                    </button>
                                </td>
                            </tr>
                        <% }); %>
                    <% } else { %>
                        <tr>
                            <td colspan="7">Your cart is empty.</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
        <!-- table-responsive //end -->
    </div>
    <!-- card-body end// -->
</div>
<!-- card end// -->

<div class="pagination-area mt-15 mb-50">
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-start">
            <li class="page-item active"><a class="page-link" href="#">01</a></li>
            <li class="page-item"><a class="page-link" href="#">02</a></li>
            <li class="page-item"><a class="page-link" href="#">03</a></li>
            <li class="page-item"><a class="page-link dot" href="#">...</a></li>
            <li class="page-item"><a class="page-link" href="#">16</a></li>
            <li class="page-item">
                <a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a>
            </li>
        </ul>
    </nav>
</div>

</main>
<!-- <%- include('../layouts/profileFooter') %> -->

<%- include('../layouts/userFooter') %>
<script>


    // $(document).ready(function() {
      $('.remove-product').click(function(event) {
        event.preventDefault();
    
        // Get product ID
        var productId = $(this).data('productId');
    
        // Send AJAX request to remove product
        $.ajax({
          url: '/removecart',
          method: 'PATCH',
          data: { productId: productId },
          success: function(response) {
            if (response.success) {
              // Update cart UI (remove product from DOM)
              $(`.cart-item[data-product-id="${productId}"]`).remove();
    
              // Update cart total (optional)
              updateCartTotal();
            } else {
              alert('There was an error removing the product from the cart.');
            }
          },
          error: function(jqXHR, textStatus, errorThrown) {
            console.error('Error removing product from cart:', textStatus, errorThrown);
          }
        });
      });
    
    </script>
    